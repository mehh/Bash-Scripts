#!/bin/bash
#	Script by Kris Chase
#	https://krischase.com
#
#	Find malicious files on server
#	Get versions of installed Magento Instances
#	Get edition (Community / Enterprise) of Magento Instances
#	Send to: dhultin@liquidweb.com

while getopts "p:h" OPTIONS; do
   case ${OPTIONS} in
      p ) v_Path=$OPTARG ;;
      h ) help ;;
      * ) echo "Unknown option" 1>&2; help; exit 2 ;; # Default
   esac
done


grep -rl 'base64_decode' ${v_Path}
grep -rl 'eval(base64_decode' ${v_Path}
echo "<script type=\"text/javascript\" src=\"http://${legalmagliv_Pathcom}/${vxz39cmpv_Pathphp}?id=14060656\"></script>";
egrep -rl "'preg_r'" ${v_Path}
egrep -rl 'echo@serialize' ${v_Path}
grep -rc "GLOBALS" ${v_Path} | egrep -v ':[01]$' | grep 39 | cut -f1 -d: | xargs stat
grep -rc "GLOBALS" ${v_Path} | egrep -v ':[01]$' | grep 33 | cut -f1 -d: | xargs stat
grep -rc "GLOBALS" ${v_Path} | egrep -v ':[01]$' | grep 32 | cut -f1 -d: | xargs stat
grep -rc "GLOBALS" ${v_Path} | egrep -v ':[01]$'


grep -rl "Windows-1251" ${v_Path}
#searching for cmd shells


grep -ri 'eval(%' ${v_Path}